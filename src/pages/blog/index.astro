---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import PostCard from "../../components/PostCard.astro";
import TerminalWindow from "../../components/TerminalWindow.astro";
import { SITE_TITLE } from "../../consts";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
const postCount = posts.length;
---

<BaseLayout title={`All Posts â€” ${SITE_TITLE}`} description="All blog posts">
  <TerminalWindow title="david@kaya ~ /posts">
    <div class="boot">
      <div>
        <span class="prompt">$</span> ls ./posts/ <span class="muted">| wc -l</span>
      </div>
      <div>
        <span class="highlight">{postCount}</span>
      </div>
      <div style="margin-top: 0.5rem">
        <span class="prompt">$</span> ls ./posts/<span class="cursor"></span>
      </div>
    </div>
  </TerminalWindow>

  <div class="posts">
    {posts.map((post) => <PostCard post={post} />)}
  </div>
</BaseLayout>

<style>
  .posts {
    margin-top: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
  }
</style>
